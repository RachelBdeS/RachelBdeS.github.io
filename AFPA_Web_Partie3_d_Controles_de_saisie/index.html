<!-- A FAIRE 
  • Page à appeler via le formulaire
-->
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <link href="./css/AFPA_Web_Partie3_d.css" rel="stylesheet">
    <title>Controles de saisie</title>
  </head>
  <body role="main">
    <form action="" method="GET" name="inscription">

      <h1>Controles de saisie</h1>

      <label>Nom : </label>
      <input 
      type="text" 
      tabindex="1" 
      name="nom" 
      placeholder="nom *" 
      title="Deux caractères minuimum sont attendus" 
      pattern="^(.{2,})$" 
      value="Toto" 
      required autofocus
      >

      <label>Prénom : </label>
      <input 
      type="text" 
      tabindex="2" 
      name="prenom" 
      placeholder="prénom *" 
      title="2 caractères minuimum sont attendus" 
      pattern="^(.{2,})$"
      value="Dupont"  
      required
      >

      <label>Numéro : </label>
      <input 
      type="number" 
      tabindex="3" 
      name="numero" 
      placeholder="numéro membre" 
      title="8 chiffres sont attendus" 
      pattern="^[0-9]{8}$"
      value="" 
      >

      <label>Rue : </label>
      <input 
      type="text" 
      tabindex="4"
      name="rue" 
      placeholder="numéro et nom de rue *"  
      title="Exemple: ''12 boulevard Machin'''" 
      pattern="^([0-9]{1,4} {1}[a-zA-Z]{1,} {1}[a-zA-Z]{1,})$" 
      value="22 rue Machin" 
      required
      >

      <label>Ville : </label>
      <input 
      type="text" 
      tabindex="5" 
      name="ville" 
      placeholder="ville" 
      title="2 caractères minuimum sont attendus" 
      pattern=".{2,}"
      value="" 
      >
      
      <label>CP : </label>
      <input 
      type="number" 
      tabindex="6" 
      name="cp" 
      placeholder="code postal" 
      title="5 chiffres sont attendus. Exemple: ''68200''" 
      pattern="^([0-9]{6})$"
      value="" 
      >

      <label>Email : </label>
      <input 
      type="text" 
      tabindex="7" 
      name="mel" 
      placeholder="mél" 
      title="Exemple: ''pseudo@domain.fr'''" 
      pattern="^([a-z]{1}[a-z0-9\_\-\.]*\@[a-z0-9\_\-\.]*\.[a-z]{2,3})$"
      value="" 
      >

      <label>Téléphone : </label>
      <input 
      type="number" 
      tabindex="8" 
      name="tel" 
      placeholder="numéro de téléphone" 
      title="10 chiffres sans espaces sont attendus. Exemple: ''0668123456'''" 
      pattern="^[0-9]{10}$"
      value="" 
      >

      <input 
      type="submit" 
      tabindex="9" 
      name="valider" 
      value="Validation" 
      disabled
      >

      <input 
      type="text"  
      tabindex="999" 
      name="toast" 
      value=""
      readonly
      >

    </form>
    <script>
      //#region -[ DECLARATIONS PUBLIQUES ]
        var toast='';
      //#endregion

      //#region -[ LISTERNERS sur les champs du formulaire ]
      document.forms.inscription.toast.onclick=function() 
      {
        this.blur();
      }
 
      document.body.onload=function() 
      {
        document.forms.inscription.valider.disabled=true;
      }

      document.forms.inscription.nom.onchange=function() 
      {
        checkField(this);
        checkPattern(this);
      }
      document.forms.inscription.prenom.onchange=function() 
      {
        checkField(this);
        checkPattern(this);
      }
      document.forms.inscription.numero.onchange=function() 
      {
        checkField(this);
        checkPattern(this);
      }
      document.forms.inscription.rue.onchange=function() 
      {
        checkField(this);
        checkPattern(this);
      }
      document.forms.inscription.ville.onchange=function() 
      {
        checkField(this);
        checkPattern(this);
      }
      document.forms.inscription.cp.onchange=function() 
      {
        checkField(this);
        checkPattern(this);
      }
      document.forms.inscription.mel.onchange=function() 
      {
        checkField(this);
        checkPattern(this);
      }
      document.forms.inscription.tel.onchange=function() 
      {
        checkField(this);
        checkPattern(this);
      }

      document.forms.inscription.onsubmit=function() 
        {
          document.forms.inscription.checkValidity()? 1==1: writePage();
        }
//#endregion

      //#region [ FONCTIONS APPELLEES ]
        function checkField(e)
        {
          e.value=e.value.trim();
          if (!e.value===undefined || !e.value=='') 
          {
            e.setAttribute('required', 'required');
          }
          else 
          {
            e.removeAttribute('required');
          }
        }

        function checkPattern(e) 
        {
          if (e.value=='' || /e.pattern/.test(e.value))
          {
            toast='';
          }
          else if (e.required)
          {
            toast=`Pour le ${e.name}, ${e.title}.`;
          }
          document.forms.inscription.toast.value=toast;
        }
        
        function writePage() 
        {
          let contenu='';
          contenu+='HELLO'; //ooo
          let compte = window.open('', "_self");
          compte.title='Mon compte';
          compte.document.write(contenu);
        }
      //#endregion

    </script>
  </body>
</html>
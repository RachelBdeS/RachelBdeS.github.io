<!-- A FAIRE 
  • Page à appeler via le formulaire
-->
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <link href="./css/AFPA_Web_Partie3_d.css" rel="stylesheet">
    <title>Controles de saisie</title>
  </head>
  <body role="main">
    <form action="" method="GET" name="inscription">

      <h1>Controles de saisie</h1>

      <label>Nom : </label>
      <input type="text" name="nom" value="Toto" placeholder="nom *" tabindex="1" title="Deux caractères minuimum sont attendus" pattern="^(.{2,})$" required autofocus>

      <label>Prénom : </label>
      <input type="text" name="prenom" value="Dupont" placeholder="prénom *" tabindex="2" title="2 caractères minuimum sont attendus" pattern="^(.{2,})$" required>

      <label>Numéro : </label>
      <input type="number" name="numero" value="" placeholder="numéro membre" class="nombre" tabindex="3" maxlength="8" title="8 chiffres sont attendus" pattern="^[0-9]{8}$">

      <label>Rue : </label>
      <input type="text" name="rue" value="22 rue Machin" placeholder="numéro et nom de rue *" tabindex="4" title="Exemple: ''12 boulevard Machin'''" pattern="^([0-9]{1,4} {1}[a-zA-Z]{1,} {1}[a-zA-Z]{1,})$" required>

      <label>Ville : </label>
      <input type="text" name="ville" value="" placeholder="ville" tabindex="5" title="2 caractères minuimum sont attendus" pattern=".{2,}">
      
      <label>CP : </label>
      <input type="number" name="cp" value="" placeholder="code postal" class="nombre" tabindex="6" maxlength="5" title="5 chiffres sont attendus. Exemple: ''68200''" pattern="^([0-9]{6})$">

      <label>Email : </label>
      <input type="text" name="mel" value="" placeholder="mél" tabindex="7" title="Exemple: ''pseudo@domain.fr'''" pattern="^([a-z]{1}[a-z0-9\_\-\.]*\@[a-z0-9\_\-\.]*\.[a-z]{2,3})$">

      <label>Téléphone : </label>
      <input type="number" name="tel" value="" placeholder="numéro de téléphone" class="nombre" tabindex="8" title="10 chiffres sans espaces sont attendus. Exemple: ''0668123456'''" pattern="^[0-9]{10}$">

      <button type="submit" tabindex="9">Validation</button>

      <p class="toast"></p>

    </form>
    <script>
      //#region -[ DECLARATIONS PUBLIQUES ]
        var toast='';
      //#endregion

      //#region -[ LISTERNERS sur les champs du formulaire ]
        document.forms.inscription.onmouseover=function() 
        {
          let element;
          for (i=(document.forms.inscription.querySelectorAll('input').length-1); i>=0; i--) 
          {
            element=document.forms.inscription.querySelectorAll('input')[i];
            checkField(element);
            if (element.type=='number') {checkNumber(element)}
            console.log(i);
            console.log(element);
          }
        }

        document.forms.inscription.onsubmit=function() 
        {
          document.forms.inscription.checkValidity()? 1==1: writePage();
        }
      //#endregion
      
      //#region [ FONCTIONS APPELLEES ]
        function checkField(e)
        {
          e.value=e.value.trim();
          if (!e.value===undefined || !e.value=='') 
          {
            e.setAttribute('required', 'required');
          }
          else 
          {
            e.removeAttribute('required');
          }
        }

        function checkNumber(e) 
        {
          if (e.value=='' || /e.pattern/.test(e.value))
          {
            toast='';
          }
          else if (e.required)
          {
            toast=`Pour le <u>${e.name}</u>, ${e.title}.`;
          }

          document.querySelector('p.toast').innerHTML=toast;
        }

        function writePage() 
        {
          let contenu='';
          contenu+='HELLO'; //ooo
          let compte = window.open('', "_self");
          compte.title='Mon compte';
          compte.document.write(contenu);
        }
      //#endregion

    </script>
  </body>
</html>